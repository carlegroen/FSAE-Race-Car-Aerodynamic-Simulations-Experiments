% !TEX root = main.tex
\documentclass[english,a4paper,12pt,oneside]{memoir}

\usepackage{amsmath}
\usepackage{lipsum}
\newtheorem{lemma}{Lemma}
\usepackage[draft,english]{fixme}
\usepackage[export]{adjustbox}
\usepackage{enumitem}
\usepackage{pgfplots}



%\usepackage{fontspec}
%\defaultfontfeatures{Ligatures={TeX}}
%\setmainfont{Arno Pro}

% ting til memoir
\setlrmarginsandblock{4.2cm}{*}{1}
\setulmarginsandblock{3.5cm}{*}{1}
\setheadfoot{2\onelineskip}{\footskip}
\checkandfixthelayout

% gør at subsections også nummeres
\setsecnumdepth{subsection}

\setcounter{tocdepth}{2}

%%%%%%
% ABSTRACT STYLE
%%%%%%
\makechapterstyle{abstract}{
  \renewcommand*{\printchaptername}{}
%  \renewcommand*{\chapnumfont}{\normalfont\sffamily\huge\bfseries}
  \renewcommand*{\printchapternum}{
    \flushleft
    \begin{tikzpicture}
      \draw[fill,color=black] (0,0) rectangle (2cm,2cm);
      \draw[color=white] (1cm,1cm) node { \chapnumfont\thechapter };
    \end{tikzpicture}
  }
 % \renewcommand*{\chaptitlefont}{\normalfont\sffamily\Huge\bfseries}
  \renewcommand*{\printchaptertitle}[1]{\center\chaptitlefont\Large##1}
}
%%%%%%

%%%%%%
% PAGESTYLE
%%%%%%
\makepagestyle{main}
\makepsmarks{main}{
  \createmark{chapter}      {both}{shownumber}{}{. \ }
  \createmark{section}      {both}{shownumber}{}{. \ }
  %\createmark{subsection}   {both}{shownumber}{}{. \ }
  % \createplainmark{toc}     {both}{\contentsname}
  % \createplainmark{lof}     {both}{\listfigurename}
  % \createplainmark{lot}     {both}{\listtablename}
  % \createplainmark{bib}     {both}{\bibname}
  % \createplainmark{index}   {both}{\indexname}
  % \createplainmark{glossary}{both}{\glossaryname}
}
\makeoddhead{main}{}{}{\rightmark}
\makeevenhead{main}{\leftmark}{}{}
% sidens fod: sidetal
\makeoddfoot{main}{}{}{\thepage}
\makeevenfoot{main}{\thepage}{}{}
% smid en linie under
\makeheadrule{main}{\textwidth}{\normalrulethickness}

% \setsecheadstyle{\large\bfseries\raggedright}
% \setsubsecheadstyle{\normalsize\bfseries\raggedright}

\nouppercaseheads
\pagestyle{main}
%%%%%%

%%%%%%
% CHAPTER PAGE STYLE
%%%%%%
% \makeoddhead{plain}{}{}{}
% \makeevenhead{plain}{}{}{}
% % sidens fod: sidetal
% \makeoddfoot{plain}{}{}{\thepage}
% \makeevenfoot{plain}{\thepage}{}{}
% \aliaspagestyle{chapter}{plain} % make chapter pages same page style as everything else


%%%%%%
% CHAPTER STYLE
%%%%%%
%\usepackage[table]{xcolor}
\usepackage{tikz}

\makechapterstyle{box}{
  \renewcommand*{\printchaptername}{}
%  \renewcommand*{\chapnumfont}{\normalfont\sffamily\huge\bfseries}
  \renewcommand*{\printchapternum}{
    \flushleft
    \begin{tikzpicture}
      \draw[fill,color=black] (0,0) rectangle (2cm,2cm);
      \draw[color=white] (1cm,1cm) node { \chapnumfont\thechapter };
    \end{tikzpicture}
  }
 % \renewcommand*{\chaptitlefont}{\normalfont\sffamily\Huge\bfseries}
  \renewcommand*{\printchaptertitle}[1]{\flushleft\chaptitlefont##1}
}
%%%%%%


% used for flow charts
\usetikzlibrary{shapes,arrows}
% Define block styles
\tikzstyle{decision} = [diamond, draw, fill=blue!10,
    text width=9em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!10,
    text width=10em, text centered, rounded corners, minimum height=4em]
\tikzstyle{line} = [draw, -latex']


\usepackage[utf8]{inputenc}	%Tillader danske tegn
\usepackage[T1]{fontenc}	%Tillader danske tegn
\usepackage{graphicx}		%Tillader indsættelse af billeder
\usepackage{dcolumn}		%Bruges til at lave matematiske tabelsøjler... se datatabel
\usepackage{mathtools}		%Ekstra matematik... bare lad den være, du får muligvis brug for den.
\usepackage{siunitx}
\usepackage{microtype}
\usepackage{amssymb}
\usepackage{rotating}


\usepackage{booktabs}
\setlength{\heavyrulewidth}{0.15em}
\setlength{\lightrulewidth}{0.08em}

% Where to look for figures
\graphicspath{ {./figures/} }

\newcommand{\mc}[1]{\multicolumn{1}{c}{#1}}
%\usepackage{threeparttable}
%\usepackage{multirow}

\numberwithin{equation}{chapter}
\numberwithin{table}{chapter}
\numberwithin{figure}{chapter}
\usepackage{varioref}
\usepackage[hidelinks]{hyperref}
\usepackage[draft]{fixme}
\linespread{1.15}
\usepackage[sc]{mathpazo}
\usepackage{wasysym}
\usepackage{cite}
\usepackage{multirow}

%\newsubfloat{figure}
%\RequirePackage[caption=false,position=top]{subfig}
%\let\subtop\subfloat

\usepackage{caption}
\captionsetup[figure]{labelfont=bf, textfont={}}
\captionsetup[table]{labelfont=bf, textfont={}}

\parindent 0pt
\setlength{\parskip}{2mm plus0mm minus0mm}

% Included chapters
\includeonly{
introduction,
theory,
simulation,
experiment,
discussion,
conclusion,
perspective,
appendices
}


% Macros
\newcommand{\sref}[1]{Section~\ref{#1}}
\renewcommand{\fref}[1]{Figure~\ref{#1}}
\renewcommand{\tref}[1]{Table~\ref{#1}}
\renewcommand{\eqref}[1]{Equation~(\ref{#1})}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\half}[0]{\frac{1}{2}}
\newcommand{\mean}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\pdiff}[2]{\frac{\partial #1}{\partial #2}} % Partial derivative
\newcommand{\ppdiff}[2]{\frac{\partial^2 #1}{\partial #2^2}} % Partial derivative
\newcommand{\mat}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\norm}[1]{|#1|}
\newcommand{\cov}[0]{\text{cov}}
\newcommand*\chem[1]{\ensuremath{\mathrm{#1}}}

\usepackage{listings}
\usepackage{color}
\usepackage{textcomp}
\definecolor{listinggray}{gray}{0.9}
\definecolor{lbcolor}{rgb}{1,1,1}
\lstset{
	backgroundcolor=\color{lbcolor},
	tabsize=2,
	rulecolor=,
	language=matlab,
        basicstyle=\scriptsize,
        upquote=true,
        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=true,
        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        frame=single,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
}

%%%%% BEGIN DOCUMENT %%%%%
\begin{document}
\pagenumbering{roman}
\pagestyle{plain}
\input{frontpage}
\setcounter{page}{3}
\input{preface}
\input{abstract}
\newpage\thispagestyle{empty}\mbox{}\newpage
\tableofcontents*
%\newpage\thispagestyle{empty}\mbox{}\newpage
\newpage
\pagenumbering{arabic}
\setcounter{page}{1}
\pagestyle{main}

%%%%% INCLUDE CONTENT FILES %%%%%

%\include{filename}
\include{introduction}
\include{theory}
\include{simulation}
\include{experiment}
\include{discussion}
\include{conclusion}
\include{perspective}
\include{appendices}

%%%%% BIBLIOGRAPHY %%%%%
\nocite{*}
\bibliographystyle{unsrt}
\bibliography{references}
\end{document}
